USE northwind;
SELECT * FROM purchase_order_details;
 

/* 01. Для каждого product_id выведите дату его получения date_received, предыдущую и последующую даты получения этого продукта. 
       Оставьте только строки, где date_received не является пропуском. */



/* 02. Найдите время отправки заказа date_received и время отправки предыдущего заказа. 
       Для начала оставьте только уникальные пары purchase_order_id, date_received и  отфильтруйте строки,
       там, где date_received не указано. Запишите результат в CTE и дальше работайте с ним. */
       

-- 03. Выведите максимальное количество quantity и минимальный unit_cost для каждого inventory_id с помощью функции FIRST_VALUE().



-- 04. Выведите одно значения – насколько в среднем отличается unit_cost для каждой строки от максимального unit_cost.



/* 05. Выберите ТОП 5 продуктов с максимальным quantity, используя DENSE_RANK().
	(Иными словами, проранжируйте все продукты с помощью DENSE_RANK() и оставьте только те, где ранг <= 5)*/


-- 06. Пронумеруйте строки в соответствии с убыванием inventory_id. Выведите только 13-ю строчку.

